<!doctype html>
<html>
 
<head>
    <title>Preasure measurements</title>
    <script src = "Chart.min.js"></script>
    <script src = "d3.min.js"></script>
    
</head>
 
<body>
    <div>
      <div id="wrapper">
        <canvas id="chart"></canvas>
    </div>
<br>
<br>    

<script>

function makeChart(dataInput) {

  var timeLabels = dataInput.map(function(d) {
    return d.Time;
  });
  var ampData = dataInput.map(function(d) {
    return d.Amplitude;
  });

  console.log(dataInput)
  var chart = new Chart('chart', {
    type: "line",
    options: {
      maintainAspectRatio: false,
      legend: {
        display: false
      }
    },
    data: {
      labels: timeLabels,
      datasets: [
        {
          data: ampData
        }
      ]
    }
  });
}


function getSearchParameters() {
      var prmstr = window.location.search.substr(1);
      return prmstr != null && prmstr != "" ? transformToAssocArray(prmstr) : {};
}

function transformToAssocArray( prmstr ) {
    var params = {};
    var prmarr = prmstr.split("&");
    for ( var i = 0; i < prmarr.length; i++) {
        var tmparr = prmarr[i].split("=");
        params[tmparr[0]] = tmparr[1];
    }
    return params;
}

var params = getSearchParameters();
var logfile=params.file;
// Request data using D3
d3.csv(logfile).then(makeChart);

</script>
</body>
 
</html>
 